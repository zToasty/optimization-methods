# Вопрос 18. Двойственная задача линейного программирования. Теоремы двойственности. Экономическая модель.

**Где читать в учебнике:**
*   **Стр. 168:** Основные понятия (4.4.1).
*   **Стр. 169:** Теоремы двойственности.
*   **Стр. 173:** Таблица соответствия прямой и двойственной задач.

**Суть:** Каждой задаче ЛП (Прямой) соответствует другая задача (Двойственная), составленная из тех же чисел, но перевернутая. Они как инь и ян: решение одной автоматически дает решение другой.

---

## 1. Построение двойственной задачи

Пусть у нас есть **Прямая задача** (обычно на максимум прибыли):
$$
\begin{cases}
Z = \sum_{j=1}^{n} c_j x_j \to \max \\
\sum_{j=1}^{n} a_{ij} x_j \le b_i, \quad i=1,\dots,m \\
x_j \ge 0
\end{cases}
$$

Тогда **Двойственная задача** (на минимум стоимости ресурсов) выглядит так:
1.  **Цель меняется:** был $\max$, стал $\min$.
2.  **Коэффициенты меняются местами:**
    *   $c$ (цены товаров) становятся ограничениями.
    *   $b$ (запасы ресурсов) становятся целевой функцией.
    *   Матрица $A$ транспонируется (строки становятся столбцами).
3.  **Переменные:** Вводим новые переменные $y_1, \dots, y_m$ (по одной на каждое ограничение прямой задачи).

$$
\begin{cases}
F = \sum_{i=1}^{m} b_i y_i \to \min \\
\sum_{i=1}^{m} a_{ij} y_i \ge c_j, \quad j=1,\dots,n \\
y_i \ge 0
\end{cases}
$$

---

## 2. Теоремы двойственности

> [!info] Первая (основная) теорема двойственности
> Если одна из пары двойственных задач имеет оптимальное решение, то и другая имеет оптимальное решение, причем значения их целевых функций **совпадают**:
> $$ \max Z = \min F $$
> $$ \sum c_j x_j^* = \sum b_i y_i^* $$
>
> *   Если в одной задаче целевая функция уходит в бесконечность, то у другой задачи **нет допустимых решений**.

> [!info] Вторая теорема (о дополняющей нежесткости)
> Пусть $x^*$ и $y^*$ — допустимые решения. Они являются оптимальными тогда и только тогда, когда выполняются условия:
>
> 1.  $y_i^* \cdot (\sum a_{ij} x_j^* - b_i) = 0$
>     *   Если ресурс используется не полностью (остаток $>0$), его двойственная оценка $y_i = 0$.
>     *   Если цена ресурса $y_i > 0$, то он используется полностью (дефицит).
>
> 2.  $x_j^* \cdot (\sum a_{ij} y_i^* - c_j) = 0$
>     *   Если производство товара $x_j$ убыточно (затраты > цены), то мы его не производим ($x_j=0$).

---

## 3. Экономическая модель («Цены ресурсов»)

Это самое крутое объяснение "на пальцах".

> [!example] Завод и Скупщик
> **Прямая задача (Завод):**
> У нас есть склад с досками и гвоздями ($b$). Мы делаем столы и стулья ($x$). Продаем их по ценам ($c$).
> *   **Цель:** Получить максимум выручки от продажи мебели.
>
> **Двойственная задача (Скупщик):**
> Приходит Скупщик и говорит: «Не мучайся с производством. Продай мне все свои доски и гвозди прямо со склада».
> По каким ценам ($y$) он должен их купить?
>
> 1.  **Цель Скупщика ($b \cdot y \to \min$):** Купить ресурсы как можно дешевле.
> 2.  **Ограничение Скупщика ($A^T y \ge c$):** Он должен предложить такую цену за сырье, чтобы нам было **невыгодно** самим делать мебель.
>     *   Если (цена досок + цена гвоздей) < (цены готового стула), мы скажем: «Иди лесом, я лучше сделаю стул и продам дороже».
>     *   Он обязан предложить цены так, чтобы стоимость ресурсов в изделии была **не меньше** цены изделия.
>
> **Вывод (Первая теорема):** В условиях идеального рынка (оптимума) наша максимальная прибыль от мебели **в точности равна** той сумме, которую предложит Скупщик за ресурсы.
>
> **Переменные $y_i$ (двойственные оценки):** Это **теневые цены** (объективно обусловленные оценки). Они показывают, сколько прибыли приносит **одна дополнительная единица** этого ресурса. Если $y_{доски} = 50$, значит, найдя одну лишнюю доску, мы увеличим прибыль завода на 50 руб.

---

## 4. Пример составления (Симметричная пара)

**Прямая задача:**
$$
\begin{cases}
2x_1 + 3x_2 \to \max \\
x_1 + 2x_2 \le 10 \quad (y_1) \\
3x_1 + x_2 \le 15 \quad (y_2) \\
x_1, x_2 \ge 0
\end{cases}
$$

**Двойственная задача:**
1.  Переменных будет 2 (так как 2 ограничения): $y_1, y_2$.
2.  Целевая функция — из правых частей $b$:
    $$ 10y_1 + 15y_2 \to \min $$
3.  Ограничения — читаем матрицу по столбцам (транспонируем):
    *   Столбец при $x_1$ превращается в строку для $y$: $1y_1 + 3y_2 \ge 2$ (знак $\ge$, т.к. минимум).
    *   Столбец при $x_2$ превращается в строку для $y$: $2y_1 + 1y_2 \ge 3$.
4.  Неотрицательность: $y_1, y_2 \ge 0$.

**Итого двойственная:**
$$
\begin{cases}
10y_1 + 15y_2 \to \min \\
y_1 + 3y_2 \ge 2 \\
2y_1 + y_2 \ge 3 \\
y_1, y_2 \ge 0
\end{cases}
$$

---

## 5. Навигация
<< [[Q17 - Лексикографический метод]] | [[00_ПЛАН_ПОДГОТОВКИ]] | [[Q19 - Метод возможных направлений]] >>
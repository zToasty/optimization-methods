# Вопрос 26. Задача целочисленного линейного программирования. Метод отсечений Гомори.

**Где читать в учебнике:**
*   **Стр. 230:** Геометрическая идея (Рис. 6.4, 6.5).
*   **Стр. 231:** Формула отсечения (6.8).

**Задача:**
$$ f(x) \to \min, \quad Ax = b, \quad x \ge 0, \quad x \in Z \text{ (целые)} $$

---

## 1. Идея метода (Объяснение на пальцах)

> [!example] Скульптор и глина
> Представь, что множество допустимых решений обычной (непрерывной) задачи — это многогранный кусок глины. Внутри него «спрятаны» целые точки (атомы), которые нам нужны.
>
> 1.  **Решаем непрерывную задачу:** Мы находим самую лучшую точку в глине. Оказывается, это дробная точка (например, на самой острой грани).
> 2.  **Отсечение (The Cut):** Мы берем нож и отрезаем этот острый кусок глины.
>     *   **Главное правило:** Мы должны отрезать дробный оптимум, но **не задеть ни одной целой точки** внутри.
> 3.  **Повтор:** У нас получился новый, чуть меньший многогранник. Ищем оптимум в нем. Если он снова дробный — режем еще раз.
> 4.  **Финиш:** В конце концов, грани многогранника станут проходить прямо через целые точки. Очередной непрерывный оптимум окажется целым.

---

## 2. Алгоритм Гомори

> [!info] Шаг 1. Симплекс-метод
> Решаем задачу как обычную линейную (забыв про целочисленность).
> Получаем оптимальную симплекс-таблицу.
> Проверяем корни ($b_i$):
> *   Если все $b_i$ целые — **Ура!** Задача решена.
> *   Если есть дробные — идем дальше.

> [!info] Шаг 2. Выбор строки
> Выбираем строку с самой большой дробной частью свободного члена $b_i$.
> Пусть это строка $k$.
> Уравнение этой строки выглядит так:
> $$ x_k + \sum a_{kj} x_j = b_k $$

> [!info] Шаг 3. Построение отсечения (Правило Гомори)
> Мы формируем новое ограничение.
> Для этого берем **дробные части** от всех коэффициентов строки и свободного члена.
>
> *   $\{b_k\}$ — дробная часть свободного члена (например, для $3.7$ это $0.7$).
> *   $\{a_{kj}\}$ — дробные части коэффициентов.
>
> **Неравенство Гомори:**
> $$ \sum_{j \in \text{небазисные}} \{a_{kj}\} x_j \ge \{b_k\} $$
>
> Чтобы добавить это в таблицу (которая работает с равенствами), вводим новую переменную $s_1$:
> $$ s_1 = -\{b_k\} + \sum \{a_{kj}\} x_j $$
> Добавляем эту новую строку в симплекс-таблицу.

> [!info] Шаг 4. Решение новой задачи
> Полученная система решается дальше (обычно используют Двойственный симплекс-метод, так как мы испортили допустимость, сделав свободный член отрицательным $-\{b_k\}$).
> Возвращаемся к Шагу 1.

---

## 3. Численный пример (Генерация отсечения)

Допустим, последняя строка симплекс-таблицы выглядит так:
$$ x_1 + 1.2 x_2 + 3.7 x_3 = 5.9 $$
Здесь $x_1$ — базисная переменная.
Свободный член $b = 5.9$ — дробный. Нас это не устраивает.

**Строим отсечение:**
1.  Берем дробные части:
    *   От $b$: $\{5.9\} = 0.9$.
    *   От $x_2$: $\{1.2\} = 0.2$.
    *   От $x_3$: $\{3.7\} = 0.7$.
2.  Записываем неравенство:
    $$ 0.2 x_2 + 0.7 x_3 \ge 0.9 $$
    *(Логика: дробные части слева должны "накопить" достаточно, чтобы компенсировать дробный хвостик 0.9 и сделать $x_1$ целым).*
3.  Вводим переменную $s_1$ и добавляем в таблицу:
    $$ s_1 - 0.2 x_2 - 0.7 x_3 = -0.9 $$

Теперь у нас новая задача, где старая точка (где $x_2=0, x_3=0$) стала недопустимой ($0 \ge 0.9$ — ложь). Мы отрезали старое решение.

---

## 4. Навигация
<< [[Q25 - Метод ветвей и границ]] | [[00_ПЛАН_ПОДГОТОВКИ]] | [[00_БАЗА_ЗНАНИЙ]] >>
# Вопрос 19. Численные методы решения задач нелинейного программирования. Метод возможных направлений.

**Где читать в учебнике:**
*   **Стр. 193:** Введение (5.2).
*   **Стр. 194:** Определение направления спуска.
*   **Стр. 195:** Задача линейного программирования для поиска направления.

**Задача:**
$$ f(x) \to \min, \quad x \in U $$
Где $U$ задано нелинейными неравенствами $g_i(x) \le 0$.

---

## 1. Идея метода (Объяснение на пальцах)

> [!example] Аналогия с темной комнатой
> Представь, что ты находишься в комнате сложной формы (допустимое множество $U$). Пол в комнате наклонный, ты хочешь попасть в самую низкую точку.
>
> 1.  **Центр комнаты:** Если ты стоишь в центре, ты просто идешь вниз по уклону (по антиградиенту $-\nabla f$). Это обычный спуск.
> 2.  **Стена:** Ты уперся в стену (активное ограничение). Антиградиент показывает "сквозь стену", но туда нельзя.
> 3.  **Что делать?** Тебе нужно найти такое направление, которое:
>     *   Ведет **вниз** (функция уменьшается).
>     *   Ведет **внутрь** комнаты или вдоль стены (не нарушает ограничений).
>
> Такое направление называется **возможным** (допустимым) и **пригодным** (убывающим). Ты начинаешь "скользить" вдоль стены вниз, пока не упрешься в угол или не найдешь минимум.

---

## 2. Алгоритм (Метод Зойтендейка)

Процесс итерационный: $x^{k+1} = x^k + \alpha_k p^k$.

> [!info] Шаг 1. Выбор направления ($p^k$)
> Нам нужно найти вектор $p$, который удовлетворяет двум условиям:
>
> 1.  **Условие убывания:** Скалярное произведение градиента функции на вектор должно быть отрицательным (угол тупой):
>     $$ \langle \nabla f(x^k), p \rangle < 0 $$
> 2.  **Условие допустимости:** Для всех **активных** ограничений (тех, где $g_i(x^k) = 0$, то есть мы у стенки) мы должны "отталкиваться" от стены внутрь:
>     $$ \langle \nabla g_i(x^k), p \rangle < 0 $$
>
> Чтобы найти *наилучшее* такое направление, решается вспомогательная **задача линейного программирования** (ЗЛП).

> [!info] Шаг 2. Выбор длины шага ($\alpha_k$)
> Мы идем по лучу $x^k + \alpha p^k$.
> Нам нужно остановиться, если:
> *   Либо мы достигли минимума функции на этом луче.
> *   Либо мы уперлись в *новую* стенку (ограничение).
>
> Выбираем $\alpha_k$ как минимум из этих двух дистанций.

> [!info] Шаг 3. Переход
> Переходим в новую точку. Если градиент стал очень маленьким или мы не можем сделать шаг — стоп.

---

## 3. Математическая формулировка (Как найти p)

На итерации $k$ мы решаем задачу поиска вектора $p$:
$$ \sigma \to \min $$
При условиях:
1.  $\langle \nabla f(x^k), p \rangle \le \sigma$ (Хотим сильно уменьшить функцию)
2.  $\langle \nabla g_i(x^k), p \rangle \le \sigma, \quad i \in I(x^k)$ (Хотим уйти от активных стенок)
3.  Ограничение на длину вектора (чтобы не ушел в бесконечность), например $|p_j| \le 1$.

*   Если $\sigma_{min} < 0$, то найденное направление $p$ ведет нас к улучшению.
*   Если $\sigma_{min} = 0$, то мы в тупике (выполнены условия Куна-Таккера), это точка оптимума.

---

## 4. Численный пример (Поиск направления)

**Задача:**
Минимизировать $f(x) = -x_1 - x_2$ (хотим, чтобы $x_1$ и $x_2$ были как можно больше).
Ограничение: круг радиуса 5.
$$ g(x) = x_1^2 + x_2^2 - 25 \le 0 $$

**Ситуация:**
Мы находимся в точке $x^0 = (3, 4)$.
Проверим ограничение: $3^2 + 4^2 - 25 = 25 - 25 = 0$.
**Вывод:** Мы находимся на границе (у стенки). Ограничение **активно**.

**Шаг 1. Считаем градиенты**
1.  Градиент функции (куда хотим идти):
    $$ \nabla f(x) = (-1, -1) $$
    Антиградиент (наилучший спуск): $(1, 1)$. Мы хотим идти по диагонали вправо-вверх.

2.  Градиент ограничения (нормаль к стенке):
    $$ \nabla g(x) = (2x_1, 2x_2) $$
    В точке $(3, 4)$: $\nabla g(x^0) = (6, 8)$. Этот вектор смотрит из круга наружу.

**Шаг 2. Формируем условия для вектора $p = (p_1, p_2)$**
Нам нужен такой вектор направления $p$, который:
1.  **Уменьшает функцию:** $\langle \nabla f, p \rangle < 0$
    $$ -1 \cdot p_1 + (-1) \cdot p_2 < 0 \quad \Rightarrow \quad p_1 + p_2 > 0 $$
2.  **Допустим (ведет внутрь круга):** $\langle \nabla g, p \rangle < 0$
    $$ 6p_1 + 8p_2 < 0 $$

**Шаг 3. Анализ**
Попытка пойти по антиградиенту $p=(1, 1)$:
*   $p_1+p_2 = 2 > 0$ (Функция убывает, хорошо).
*   $6(1) + 8(1) = 14 \not< 0$ (Мы вылетим за круг! Плохо).

Нам нужно решить систему (вспомогательную задачу ЛП), чтобы найти компромисс.
Например, вектор $p = (1, -1)$ (идем вправо-вниз):
*   $1 + (-1) = 0$ (функция не меняется, скользим по линии уровня).
*   $6(1) + 8(-1) = -2 < 0$ (заходим внутрь круга).

Вектор $p = (4, -3)$ (касательная к кругу):
*   $4 + (-3) = 1 > 0$ (функция убывает).
*   $6(4) + 8(-3) = 24 - 24 = 0$ (скользим ровно по границе).
Это и есть **возможное направление**.

## 4. Навигация
<< [[Q18 - Двойственность в ЛП]] | [[00_ПЛАН_ПОДГОТОВКИ]] | [[Q20 - Метод проекции градиента]] >>
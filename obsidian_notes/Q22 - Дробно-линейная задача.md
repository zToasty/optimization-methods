# Вопрос 22. Задача с дробно-линейной целевой функцией.

**Где читать в учебнике:**
*   **Стр. 187:** Постановка задачи (5.1.1).
*   **Стр. 188:** Замена переменных и сведение к ЛП.

**Суть:** Нам нужно найти оптимум, когда целевая функция — это **дробь** (числитель и знаменатель линейные), а ограничения — обычные линейные.

---

## 1. Постановка задачи (из лекций)

$$ f(x) = \frac{\langle a, x \rangle + b}{\langle c, x \rangle + d} \to \min $$

При линейных ограничениях:
$$ \sum_{i=1}^{n} a_{ij} x_i \le b_j, \quad j=1, \dots, m $$

> [!warning] Важное условие
> Знаменатель $D(x) = \langle c, x \rangle + d$ **не должен менять знак** на множестве допустимых решений $U$.
> *   Обычно полагают, что $D(x) > 0$ для всех $x \in U$.
> *   Если это не так, задача становится некорректной (разрывы второго рода) или требует разбиения множества $U$.

---

## 2. Идея решения (Замена переменных)

Мы сводим задачу к **Линейному Программированию (ЛП)** с помощью замены переменных (Схема Чарнса-Купера).

**Вводим новые переменные:**
1.  **Масштабирующий множитель:**
    $$ \tilde{x}_0 = \frac{1}{\langle c, x \rangle + d} $$
    *(Обратная величина знаменателя)*.

2.  **Новые основные переменные:**
    $$ \tilde{x}_i = x_i \cdot \tilde{x}_0, \quad i=1, \dots, n $$

---

## 3. Новая задача ЛП (Алгоритм сведения)

Мы переписываем задачу относительно переменных $(\tilde{x}_1, \dots, \tilde{x}_n, \tilde{x}_0)$.

> [!info] 1. Новая целевая функция
> Числитель старой дроби становится линейной функцией:
> $$ \sum_{i=1}^{n} a_{0i} \tilde{x}_i + b_0 \tilde{x}_0 \to \min $$

> [!info] 2. Новые ограничения
> Исходные ограничения ($Ax \le b$) умножаются на $\tilde{x}_0$ и становятся линейными:
> $$ \sum_{i=1}^{n} a_{ij} \tilde{x}_i \le b_j \cdot \tilde{x}_0 $$
> *(Или в каноническом виде: $\sum a_{ij} \tilde{x}_i - b_j \tilde{x}_0 \le 0$)*.

> [!info] 3. Условие нормировки
> Мы обязаны зафиксировать, что знаменатель равен $1/\tilde{x}_0$:
> $$ \langle c, \tilde{x} \rangle + d \cdot \tilde{x}_0 = 1 $$
> *(Где $\tilde{x}$ — вектор из компонентов $\tilde{x}_1 \dots \tilde{x}_n$)*.

> [!info] 4. Решение
> 1.  Решаем полученную задачу ЛП (относительно $\tilde{x}, \tilde{x}_0$) обычным **Симплекс-методом** (см. [[Q15 - Симплекс-алгоритм]]).
> 2.  Получаем ответ $(\tilde{x}^*, \tilde{x}_0^*)$.
> 3.  Возвращаемся к исходным переменным:
>     $$ x^* = \frac{\tilde{x}^*}{\tilde{x}_0^*} $$

---

## 4. Численный пример

**Задача:**
$$ f(x) = \frac{2x_1 + 5}{x_1 + x_2 + 3} \to \max $$
Ограничение:
$$ -x_1 + 3x_2 \le 4 $$

**Решение:**
1.  **Новая переменная $\tilde{x}_0$:**
    $$ \tilde{x}_0 = \frac{1}{x_1 + x_2 + 3} $$
    Вводим $\tilde{x}_1 = x_1 \tilde{x}_0, \quad \tilde{x}_2 = x_2 \tilde{x}_0$.

2.  **Новая целевая функция:**
    $$ L(\tilde{x}) = 2\tilde{x}_1 + 5\tilde{x}_0 \to \max $$

3.  **Ограничение знаменателя (Нормировка):**
    $$ 1\tilde{x}_1 + 1\tilde{x}_2 + 3\tilde{x}_0 = 1 $$

4.  **Старое ограничение:**
    $-1x_1 + 3x_2 \le 4$.
    $$ -1\tilde{x}_1 + 3\tilde{x}_2 \le 4\tilde{x}_0 $$
    $$ -1\tilde{x}_1 + 3\tilde{x}_2 - 4\tilde{x}_0 \le 0 $$

**Итог:** Получили обычную линейную задачу с 3 переменными ($\tilde{x}_1, \tilde{x}_2, \tilde{x}_0$). Решаем её симплексом, получаем числа, делим обратно и получаем ответ.

---

## 5. Навигация
<< [[Q21 - Метод штрафных функций]] | [[00_ПЛАН_ПОДГОТОВКИ]] | [[Q23 - Квадратичное программирование]] >>
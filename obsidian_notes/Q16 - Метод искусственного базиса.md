# Вопрос 16. Метод вспомогательного (искусственного) базиса. Критерии остановки.

**Где читать в учебнике:**
*   **Стр. 161:** Раздел 4.3.5.

**Проблема:** Для старта обычного Симплекс-метода нам нужно иметь готовое **Базисное Допустимое Решение** (БДР).
*   Если ограничения вида $Ax \le b$ и $b \ge 0$, то можно просто взять $x=0$.
*   А если ограничения $Ax = b$ или $Ax \ge b$? Точка $x=0$ может нарушать правила. Найти первую вершину "в уме" сложно.

**Решение:** Мы расширяем задачу, добавляя **искусственные переменные**, чтобы получить тривиальный старт.

---

## 1. Постановка М-задачи (Задача с искусственным базисом)

Пусть исходная система ограничений:
$$ \sum_{j=1}^{n} a_{ij} x_j = b_i, \quad b_i \ge 0 $$

Мы добавляем в каждое уравнение новую неотрицательную переменную $x_{n+i}$ (искусственную):
$$ \sum_{j=1}^{n} a_{ij} x_j + x_{n+i} = b_i $$

Теперь у нас есть очевидное решение: $x_j = 0$ (старые), $x_{n+i} = b_i$ (новые). Это наш старт.

**Новая целевая функция (Вспомогательная):**
Мы хотим избавиться от этих "фейковых" переменных. Поэтому мы требуем минимизировать их сумму:
$$ W = \sum_{i=1}^{m} x_{n+i} \to \min $$

---

## 2. Алгоритм (Двухэтапный метод)

> [!info] Этап 1. Избавление от "костылей"
> Мы решаем задачу минимизации $W \to \min$ обычным Симплекс-методом.
>
> Искусственные переменные $x_{n+i}$ служат стартовым базисом. Мы пытаемся выгнать их из базиса и сделать равными нулю.

> [!info] Этап 2. Решение исходной задачи
> Если нам удалось сделать $W=0$ (все искусственные переменные обнулились), то мы оказались в допустимой вершине **исходного** многогранника.
>
> *   Мы вычеркиваем искусственные переменные из таблицы.
> *   Возвращаем старую целевую функцию $f(x)$.
> *   Продолжаем обычный симплекс-метод.

---

## 3. Критерии остановки (Исход)

Когда мы закончили Этап 1 (нашли минимум функции $W$), возможны два исхода:

> [!info] Случай А: Успех ($W_{min} = 0$)
> Если минимальное значение вспомогательной функции равно 0, значит, все искусственные переменные стали равны 0.
> **Вывод:** Исходная система ограничений **совместна**. Мы нашли начальное БДР. Можно переходить к решению основной задачи.

> [!info] Случай Б: Провал ($W_{min} > 0$)
> Мы достигли минимума, но сумма искусственных переменных все равно положительна (не удалось их обнулить).
> **Вывод:** Исходная система ограничений **несовместна** (противоречива).
> *Пример:* Потребовали $x_1 + x_2 = 5$ и $x_1 + x_2 = 10$ одновременно.
> **Решения у исходной задачи НЕ существует.**

---

## 4. Объяснение «на пальцах»

> [!example] Аналогия с вертолетом
> Представь, что многогранник допустимых решений — это остров в океане.
> Обычный симплекс-метод требует, чтобы ты уже стоял на берегу острова. Но ты плаваешь в воде (точка $x=0$ недопустима).
>
> **Метод искусственного базиса:**
> 1.  Ты вызываешь вертолет (искусственные переменные). Он поднимает тебя над водой.
> 2.  Целевая функция $W \to \min$ — это высота вертолета. Ты пытаешься снизиться и сесть на остров.
> 3.  **Успех ($W=0$):** Ты коснулся земли (острова). Вертолет улетает, дальше идешь пешком (обычный Симплекс).
> 4.  **Провал ($W > 0$):** Ты снизился максимально, но под тобой все еще вода. Значит, острова не существует (он утонул).

---

## 5. Численный пример (Этап 1)

**Задача:**
$$ x_1 + x_2 \to \min $$
Ограничение-равенство:
$$ 2x_1 + x_2 = 2, \quad x \ge 0 $$

*(Очевидно, что $x=0$ взять нельзя, т.к. $0 \neq 2$. Базиса нет).*

**Вводим искусственную переменную $u_1$:**
$$ 2x_1 + x_2 + u_1 = 2 $$
Теперь базис есть: $u_1 = 2$ (при $x_1=0, x_2=0$).

**Вспомогательная задача (Этап 1):**
$$ W = u_1 \to \min $$
Выразим $u_1$ через остальные переменные (из уравнения):
$$ u_1 = 2 - 2x_1 - x_2 $$
Значит, целевая строка для таблицы: $W = -2x_1 - x_2 + 2$ (константу 2 пока опустим, важны коэффициенты).
В таблице коэффициенты функции обычно пишутся с обратным знаком или как есть, для $W \to \min$ ищем **самый положительный** вклад в уменьшение $u_1$. Здесь $x_1$ имеет коэффициент 2 в уравнении $u_1$. Чем больше $x_1$, тем меньше $u_1$.

**Таблица 1 (Искусственная)**

| Базис | $x_1$ | $x_2$ | $u_1$ | $b$ |
| :--- | :---: | :---: | :---: | :---: |
| **$u_1$** | **2** | 1 | 1 | **2** |
| **$W$** | **-2** | -1 | 0 | **2** (значение $W$) |

*(Примечание: в W-строке записаны коэффициенты так, как они влияют на ноль. Мы хотим обнулить $u_1$).*

**Итерация:**
1.  **Столбец:** $x_1$ (самый большой по модулю коэффициент в уравнении связи, влияющий на $u_1$).
2.  **Строка:** $2 / 2 = 1$. Разрешающий элемент **2**.
3.  **Замена:** $u_1$ уходит, $x_1$ приходит.

**Таблица 2**
Делим строку на 2.

| Базис | $x_1$ | $x_2$ | $u_1$ | $b$ |
| :--- | :---: | :---: | :---: | :---: |
| **$x_1$** | 1 | 0.5 | 0.5 | **1** |
| **$W$** | 0 | 0 | ... | **0** |

**Результат:**
Значение функции $W$ стало **0**. Искусственная переменная $u_1$ ушла из базиса и равна 0.
**Успех!** Мы нашли допустимое решение исходной задачи: $x_1 = 1, x_2 = 0$.
Теперь можно вычеркнуть столбец $u_1$ и строку $W$, вернуть исходную функцию $f(x) = x_1 + x_2$ и решать дальше обычным методом.

## 6. Пример: Когда без искусственного базиса не обойтись

В простых задачах с равенствами или ограничениями $\le$ (типа $x_1 \le 5$) мы можем стартовать из точки $x=0$.
Но что делать, если ограничения требуют, чтобы $x$ был **большим**?

**Задача:**
$$ f(x) = 3x_1 + 4x_2 \to \min $$
**Ограничения:**
$$
\begin{cases}
x_1 + x_2 \ge 5 \quad (\text{Нужно произвести НЕ МЕНЬШЕ 5 единиц}) \\
x_1 - x_2 \le 1 \\
x_1, x_2 \ge 0
\end{cases}
$$

**Попытка решить «в лоб» (без искусственных переменных):**
Приведем к каноническому виду (превратим неравенства в равенства).
1.  Во втором ( ${\le 1}$ ) добавляем *слабую* переменную $s_2$:
    $$ x_1 - x_2 + s_2 = 1 $$
2.  В первом (${\ge 5}$) мы должны **вычесть** излишек $s_1$ (чтобы левая часть уменьшилась и стала равна правой):
    $$ x_1 + x_2 - s_1 = 5 $$

**Ищем стартовую точку (Базис):**
По классике Симплекс-метода, мы хотим занулить основные переменные ($x_1=0, x_2=0$) и посмотреть, чему равны добавочные.
*   Из ур. 2: $0 - 0 + s_2 = 1 \Rightarrow \mathbf{s_2 = 1}$. (Все ок, $1 \ge 0$).
*   Из ур. 1: $0 + 0 - s_1 = 5 \Rightarrow \mathbf{s_1 = -5}$.
    **КАТАСТРОФА!** Переменные в Симплекс-методе не могут быть отрицательными ($s_1 \ge 0$).

**Вывод:** Точка $(0,0)$ лежит **вне** допустимой области (мы ничего не произвели, а требовали $\ge 5$). Нам не с чего начинать таблицу.

---

**Решение через М-метод (Искусственный базис):**
Чтобы исправить уравнение с минусом, добавляем туда **искусственную переменную** $u_1$:
$$ x_1 + x_2 - s_1 + \mathbf{u_1} = 5 $$

Теперь пробуем старт ($x_1=0, x_2=0, s_1=0$):
*   $s_2 = 1$
*   $u_1 = 5$ (Положительное! Ура!)

**Стартовая таблица (Этап 1):**
Целевая функция этапа: $W = u_1 \to \min$.
Выражаем $u_1$ из уравнения: $u_1 = 5 - x_1 - x_2 + s_1$.

| Базис | $x_1$ | $x_2$ | $s_1$ | $s_2$ | $u_1$ | $b$ |
| :--- | :---: | :---: | :---: | :---: | :---: | :---: |
| **$u_1$** | 1 | 1 | -1 | 0 | 1 | **5** |
| **$s_2$** | 1 | -1 | 0 | 1 | 0 | **1** |
| **$W$** | -1 | -1 | 1 | 0 | 0 | **5** |

Теперь мы запускаем алгоритм, чтобы выгнать $u_1$ и найти точку, где $x_1+x_2 \ge 5$.
## 7. Навигация
<< [[Q15 - Симплекс-алгоритм]] | [[00_ПЛАН_ПОДГОТОВКИ]] | [[Q17 - Лексикографический метод]] >>
# Вопрос 7. Численные методы с вычислением производных. Метод хорд. Метод Ньютона.

**Где читать в учебнике:**
*   **Стр. 52:** Метод хорд (2.3.2).
*   **Стр. 53-54:** Метод Ньютона (2.3.3).

**Суть методов:**
Мы ищем минимум функции $f(x)$. Из матанализа мы знаем необходимое условие: в точке минимума производная равна нулю ($f'(x) = 0$).
Эти методы ищут не саму "яму", а корень уравнения $f'(x) = 0$.

---
## 1. Метод хорд (Secant Method)

Метод применим, когда мы знаем, что корень производной находится на отрезке $[a, b]$, и производная на концах имеет разные знаки (функция унимодальна и дифференцируема).

> [!info] Алгоритм метода хорд (Стр. 52)
>
> **Входные данные:** Отрезок $[a, b]$, точность $\varepsilon > 0$.
>
> **Шаг 1.** Найти точку пересечения хорды $\tilde{x}$ с осью абсцисс по формуле:
> $$ \tilde{x} = a - \frac{f'(a)}{f'(b) - f'(a)} (b - a) $$
> Вычислить значение производной в этой точке: $f'(\tilde{x})$. Перейти к шагу 2.
>
> **Шаг 2.** Проверка на окончание поиска.
> *   Если $|f'(\tilde{x})| \le \varepsilon$, то положить $x^* \approx \tilde{x}$, $f^* \approx f(\tilde{x})$ и поиск завершить.
> *   Иначе — перейти к шагу 3.
>
> **Шаг 3.** Переход к новому отрезку.
> *   Если $f'(\tilde{x}) > 0$, то положить $b = \tilde{x}$, $f'(b) = f'(\tilde{x})$. (Откидываем правую часть).
> *   Иначе (если $f'(\tilde{x}) < 0$) — положить $a = \tilde{x}$, $f'(a) = f'(\tilde{x})$. (Откидываем левую часть).
>
> Перейти к шагу 1.

**Пример:** См. таблицу 2.7 на стр. 53.

---

### Пример метода хорд (из учебника, стр. 53)
**Задача:** Найти минимум $f(x) = x^4 + e^{-x}$ на отрезке $[0; 1]$.
Производная: $f'(x) = 4x^3 - e^{-x}$.

**Итерация 1:**
*   $a=0, b=1$.
*   $f'(0) = -1$ (убывает).
*   $f'(1) \approx 3.63$ (возрастает).
*   По формуле хорд:
    $$ \tilde{x} = 0 - \frac{-1}{3.63 - (-1)}(1 - 0) = \frac{1}{4.63} \approx 0.216 $$
*   Считаем $f'(0.216) \approx -0.766$. Это $<0$, значит, минимум правее.
*   Новый отрезок $[0.216; 1]$.

---

## 2. Метод Ньютона (Newton's Method)

Этот метод основан на квадратичной аппроксимации функции (замене её на параболу).

> [!info] Алгоритм метода Ньютона (Стр. 54)
>
> **Входные данные:** Начальная точка $x_0$, точность $\varepsilon$.
>
> **Шаг 1.** Выбрать начальное приближение $x_0$. Положить $k = 0$.
>
> **Шаг 2.** Вычислить первую и вторую производные в текущей точке: $f'(x_k)$ и $f''(x_k)$.
>
> **Шаг 3.** Проверка условия окончания.
> *   Если $|f'(x_k)| \le \varepsilon$, то положить $x^* \approx x_k$ и завершить процедуру.
>
> **Шаг 4.** Вычислить следующую точку $x_{k+1}$ по формуле:
> $$ x_{k+1} = x_k - \frac{f'(x_k)}{f''(x_k)} $$
>
> **Шаг 5.** Увеличить счетчик итераций $k = k + 1$ и перейти к шагу 2.

**Важно:** Для работы метода вторая производная $f''(x)$ не должна быть равна нулю.


> [!example] Объяснение на пальцах
> Ты стоишь на склоне в тумане. Ты чувствуешь ногами:
> 4.  Куда наклонена земля ($f'$ — первая производная).
> 5.  Насколько земля выпуклая/вогнутая ($f''$ — вторая производная).
>
> Мозг строит модель: "Ага, судя по изгибу, это параболическая яма, и её дно должно быть через 5 метров". Ты прыгаешь сразу на 5 метров.
> *   Если яма реально была параболой — ты сразу в центре (победа за 1 шаг!).
> *   Если яма кривая — ты окажешься очень близко к центру.

---

### Пример метода Ньютона (из учебника, стр. 54)
**Задача:** Найти минимум $f(x) = x \cdot \text{arctg } x - \frac{1}{2}\ln(1+x^2)$.
Нужно найти корень производной.
1.  $f'(x) = \text{arctg } x$.
2.  $f''(x) = \frac{1}{1+x^2}$.

**Итерация 1:**
*   Начальная точка $x_0 = 1$.
*   $f'(1) = \text{arctg } 1 = \frac{\pi}{4} \approx 0.785$.
*   $f''(1) = \frac{1}{1+1} = 0.5$.
*   Шаг Ньютона:
    $$ x_1 = 1 - \frac{0.785}{0.5} = 1 - 1.57 = -0.57 $$

Метод сходится очень быстро (квадратичная скорость сходимости), если мы близко к решению.

---

## 3. Сравнение методов (для ответа)

| Метод | Что нужно знать | Скорость | Надежность |
| :--- | :--- | :--- | :--- |
| **Хорд** | Значения $f'(x)$ на краях | Средняя | Высокая (всегда внутри отрезка) |
| **Ньютона** | $f'(x)$ и $f''(x)$ в точке | Очень высокая | Низкая (может "улететь", если $x_0$ плохой) |

---

## 4. Навигация
<< [[Q06 - Методы без производных]] | [[00_ПЛАН_ПОДГОТОВКИ]] | [[Q08 - Метод ломаных]] >>
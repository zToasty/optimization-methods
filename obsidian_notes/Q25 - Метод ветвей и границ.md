# Вопрос 25. Метод ветвей и границ для дискретных задач оптимизации.

**Где читать в учебнике:**
*   **Стр. 237:** Общая идея.
*   **Стр. 240:** Схема ветвления.

**Суть:** Метод полного перебора подмножеств решений с отсечением бесперспективных вариантов с помощью оценок (границ).

---

## 1. Идея метода (из лекций)

Пусть мы ищем минимум: $f(x) \to \min, \quad x \in D$ (дискретное множество).

Мы разбиваем множество $D$ на части (ветви): $D = D_1 \cup D_2 \dots$.
Для каждого подмножества $d \subset D$ мы вычисляем две оценки:
1.  **Нижняя граница $H(d)$ (Lower Bound):** Оптимистичная оценка. Лучше (меньше) этого значения в данном подмножестве решения точно нет.
    $$ \forall x \in d \Rightarrow f(x) \ge H(d) $$
2.  **Верхняя граница $F(d)$ (Upper Bound):** Пессимистичная оценка. Это значение какого-то *конкретного* допустимого решения, которое мы уже нашли в этом подмножестве (рекорд).

**Правило отсечения (Прунинг):**
Если для какой-то ветки $d$ нижняя граница $H(d)$ хуже (больше), чем наш текущий глобальный рекорд $f^*$, то эту ветку можно **отбросить**. Там ловить нечего.

---

## 2. Алгоритм (Пошагово из лекций)

> [!info] Шаг 0 (Инициализация)
> *   $A = \{D\}$ — множество активных вершин (пока только корень — всё множество).
> *   $f^* = \infty$ — текущий рекорд (пока не найден).
> *   Выбрать правило ветвления (как делить).

> [!info] Шаг 1 (Выбор ветви)
> Выбрать из множества $A$ подмножество $d$ для рассмотрения.
> (Обычно выбирают то, у которого самая перспективная нижняя граница $H(d)$).

> [!info] Шаг 2 (Ветвление)
> Разбить $d$ на подмножества $d_1, \dots, d_k$ (например, $x_j=0$ и $x_j=1$).
> $A = (A \setminus \{d\}) \cup \{d_1, \dots, d_k\}$.

> [!info] Шаг 3 (Оценка и Отсечение)
> Для каждой новой ветки $d_i$:
> 1.  Вычислить нижнюю границу $H(d_i)$.
> 2.  Попытаться найти допустимое решение и обновить рекорд $f^*$.
> 3.  **Проверка:** Если $H(d_i) \ge f^*$ (для минимизации), то ветка $d_i$ отбрасывается (удаляется из $A$).

> [!info] Шаг 4 (Цикл)
> Если $A$ пусто — конец. Решение $f^*$.
> Иначе — переход к Шагу 1.

---

## 3. Пример: Задача о рюкзаке (из лекций)

**Задача:** Максимизировать ценность. (Обрати внимание: для максимума знаки неравенств переворачиваются. Мы отсекаем, если Верхняя Граница < Рекорда).

1.  **Оценка (Верхняя граница):**
    Мы разрешаем брать дробные части предметов (ЛП-релаксация).
    Сортируем предметы по удельной цене ($c_i/p_i$). Берем самые выгодные целиком, а последний, который не влезает — берем кусочек.
    Полученная ценность — это **потолок**. Больше в этой ветке получить невозможно.

2.  **Ветвление:**
    Берем предмет, который пришлось "пилить" (дробный).
    *   **Ветка 1 ($x_i=1$):** Обязательно берем его. (Место в рюкзаке уменьшилось).
    *   **Ветка 0 ($x_i=0$):** Запрещаем его брать. (Ищем другие варианты).

3.  **Отсечение:**
    Если в какой-то ветке "потолок" (оценка с дробью) меньше, чем ценность уже найденного целого рюкзака (рекорда) — эту ветку выкидываем.

**(См. твой скриншот с деревом: там как раз показано, как вычисляется $V=30$ и отсекаются варианты).**

---

## 4. Навигация
<< [[Q24 - Дискретные задачи]] | [[00_ПЛАН_ПОДГОТОВКИ]] | [[Q26 - Целочисленное ЛП]] >>
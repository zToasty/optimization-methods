# Вопрос 13. Теорема Куна-Таккера. (Критерий оптимальности задачи выпуклого программирования).

**Где читать в учебнике:**
*   **Стр. 142:** Теорема 4.6 (Куна-Таккера).
*   **Стр. 144:** Общий случай (смешанные ограничения).

**Связь с прошлым:** В [[Q05 - Функция Лагранжа]] мы решали задачу с равенствами ($=$). Здесь мы решаем задачу с **неравенствами** ($\le$). Это гораздо сложнее, потому что мы не знаем заранее: упремся мы в стену (ограничение) или минимум лежит свободно внутри области.

---

## 1. Постановка задачи

Мы решаем задачу **выпуклого программирования** (см. [[Q12 - Выпуклое программирование]]):
$$
\begin{cases}
f(x) \to \min \\
g_i(x) \le 0, \quad i = 1, \dots, m
\end{cases}
$$
(Функции $f$ и $g_i$ — выпуклые и дифференцируемые).

Мы строим ту же самую **Функцию Лагранжа**, что и раньше:
$$ L(x, \lambda) = f(x) + \sum_{i=1}^{m} \lambda_i g_i(x) $$

---

## 2. Теорема Куна-Таккера (Формулировка)

> [!info] Теорема (Седловая точка)
> Вектор $x^*$ является глобальным решением задачи выпуклого программирования тогда и только тогда, когда существует вектор множителей $\lambda^*$, такой что пара $(x^*, \lambda^*)$ удовлетворяет следующим условиям (Условия ККТ):
>
> **1. Стационарность (как в Лагранже):**
> Производная Лагранжа по $x$ равна нулю.
> $$ \frac{\partial L}{\partial x} = \nabla f(x^*) + \sum_{i=1}^{m} \lambda_i^* \nabla g_i(x^*) = 0 $$
>
> **2. Допустимость решения:**
> Точка должна удовлетворять ограничениям.
> $$ g_i(x^*) \le 0 $$
>
> **3. Неотрицательность множителей (ВАЖНО!):**
> Множители Лагранжа не могут быть отрицательными.
> $$ \lambda_i^* \ge 0 $$
>
> **4. Условие дополняющей нежесткости (САМОЕ ВАЖНОЕ!):**
> Либо множитель нулевой, либо ограничение выполняется как равенство.
> $$ \lambda_i^* \cdot g_i(x^*) = 0 $$

---

## 3. Объяснение «на пальцах» (Физический смысл)

Представь, что $f(x)$ — это рельеф, и ты шарик, который хочет скатиться вниз. Ограничение $g(x) \le 0$ — это забор.

> [!example] Два сценария
>
> **Сценарий А: Минимум внутри двора**
> Шарик скатился в ямку посреди двора. Он даже не коснулся забора ($g(x) < 0$, строго меньше).
> *   Мешает ли забор? Нет.
> *   Значит, сила реакции забора равна нулю ($\lambda = 0$).
> *   Работает условие 4: $\lambda \cdot g = 0 \cdot (\text{число}) = 0$.
>
> **Сценарий Б: Минимум за забором**
> Шарик хочет катиться дальше, но уперся в забор. Он давит на сетку.
> *   Мы находимся прямо на границе ($g(x) = 0$).
> *   Забор давит на шарик обратно, чтобы он не прорвался. Сила реакции есть ($\lambda > 0$).
> *   Работает условие 4: $(\text{число}) \cdot 0 = 0$.
>
> **Суть условия $\lambda_i g_i(x) = 0$:** Это **Переключатель**.
> *   Либо ограничение **пассивное** (мы не касаемся стенки, $g < 0$), тогда $\lambda = 0$.
> *   Либо ограничение **активное** (мы уперлись в стенку, $g = 0$), тогда $\lambda > 0$.
> *   Не может быть ситуации, когда мы не у стены, но стена на нас давит ($\lambda > 0, g < 0$ — невозможно).

---

## 4. Примеры решения (чтобы понять на 200%)

### Пример 1 (Минимум внутри)
**Задача:** Найти минимум $f(x) = x^2$ при условии $x \le 1$ (или $x - 1 \le 0$).
*Очевидно, минимум в точке $x=0$, и ограничение нам не мешает.*

**Проверка условиями ККТ:**
1.  $L(x, \lambda) = x^2 + \lambda(x - 1)$.
2.  Стационарность: $\frac{\partial L}{\partial x} = 2x + \lambda = 0 \Rightarrow x = - \lambda/2$.
3.  Дополняющая нежесткость: $\lambda \cdot (x - 1) = 0$.

У нас два варианта из пункта 3:
*   **Вариант А ($\lambda = 0$):**
    Если $\lambda = 0$, то из п.2 следует $x = 0$.
    Проверяем ограничение: $0 \le 1$ (Верно).
    Все условия сошлись! **Ответ: $x^*=0, \lambda^*=0$.** (Забор не понадобился).

*   **Вариант Б ($x - 1 = 0$):**
    Если $x = 1$, то из п.2 следует $2(1) + \lambda = 0 \Rightarrow \lambda = -2$.
    **Нарушено условие неотрицательности!** $\lambda$ должна быть $\ge 0$. Значит, этот вариант — ложный (мы не давим на забор, это забор тянет нас к себе, что невозможно).

---

### Пример 2 (Минимум на стенке)
**Задача:** Найти минимум $f(x) = (x-3)^2$ при условии $x \le 1$.
*Мы хотим в точку 3, но забор стоит на 1. Придется прижаться к забору.*

**Проверка условиями ККТ:**
1.  $L(x, \lambda) = (x-3)^2 + \lambda(x - 1)$.
2.  Стационарность: $\frac{\partial L}{\partial x} = 2(x-3) + \lambda = 0$.
3.  Дополняющая нежесткость: $\lambda \cdot (x - 1) = 0$.

Снова два варианта:
*   **Вариант А ($\lambda = 0$):**
    Тогда $2(x-3) = 0 \Rightarrow x = 3$.
    Проверяем ограничение: $3 \le 1$? **НЕТ!** Ложь. Решение недопустимо (оно за забором).

*   **Вариант Б ($x - 1 = 0$):**
    Тогда $x = 1$.
    Подставляем в уравнение стационарности:
    $2(1 - 3) + \lambda = 0 \Rightarrow -4 + \lambda = 0 \Rightarrow \lambda = 4$.
    Проверяем: $\lambda = 4 \ge 0$. **Все верно!**
    **Ответ: $x^*=1, \lambda^*=4$.** (Мы уперлись в забор, и он давит на нас с силой 4).

---

## 5. Навигация
<< [[Q12 - Выпуклое программирование]] | [[00_ПЛАН_ПОДГОТОВКИ]] | [[Q14 - Линейное программирование (ЛП)]] >>
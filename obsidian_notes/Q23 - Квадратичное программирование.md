# Вопрос 23. Задача квадратичного программирования.

**Где читать в учебнике:**
*   **Стр. 189:** Постановка задачи (5.1.2).
*   **Стр. 191:** Пример решения методом Вольфа.

**Суть:** Поиск минимума выпуклой квадратичной функции при линейных ограничениях.
$$ f(x) = \text{Квадрат} + \text{Линейная часть} \to \min $$

---

## 1. Постановка задачи (из лекций)

$$ f(x) = \frac{1}{2} \langle Ax, x \rangle + \langle b, x \rangle + C \to \min $$

При условиях:
$$ \langle a_j, x \rangle \le b_j, \quad j=1, \dots, m $$
$$ x_i \ge 0 $$

*   $A$ — симметричная положительно определенная матрица (чтобы была "чаша").
*   $a_j$ — векторы коэффициентов ограничений.

> [!info] Градиент целевой функции
> Для квадратичной формы $\frac{1}{2} x^T A x + b^T x$ градиент вычисляется очень просто (как производная $x^2/2 + bx$):
> $$ \nabla f(x) = Ax + b $$
> *(Это ключевой момент: градиент линеен!)*

---

## 2. Условия Куна-Таккера (Сведение к линейной системе)

Так как задача выпуклая, условия ККТ являются необходимыми и достаточными. Запишем их.

**Множители Лагранжа:**
*   $\lambda_j \ge 0$ — для ограничений неравенств ($j=1..m$).
*   $\mu_i \ge 0$ — для ограничений неотрицательности ($x_i \ge 0$).

**Система (из лекций):**
1.  **Стационарность ($\nabla L = 0$):**
    $$ Ax + b + \sum_{j=1}^{m} \lambda_j a_j - \mu = 0 $$
    *(Градиент функции + градиенты ограничений)*.

2.  **Дополняющая нежесткость (для ограничений $x$):**
    $$ \mu_i \cdot x_i = 0 $$

3.  **Дополняющая нежесткость (для ограничений $Ax \le b$):**
    Вводим выравнивающие переменные $y_j \ge 0$, чтобы превратить неравенство в равенство:
    $$ \langle a_j, x \rangle + y_j = b_j $$
    Тогда условие принимает вид:
    $$ \lambda_j \cdot y_j = 0 $$

---

## 3. Алгоритм решения (Метод Вольфа)

Мы получили систему линейных уравнений с условием "либо то, либо это равно нулю".

$$
\begin{cases}
Ax + A_{restr}^T \lambda - \mu = -b & (\text{Из стационарности}) \\
A_{restr} x + y = b_{restr} & (\text{Из ограничений})
\end{cases}
$$

> [!info] Метод искусственного базиса
> Мы решаем эту систему **Симплекс-методом** (добавив искусственные переменные для старта).
>
> **Правило запрета (из-за условий $\lambda y = 0$ и $\mu x = 0$):**
> *   Нельзя вводить в базис переменную $\lambda_j$, если там уже есть $y_j$ (и наоборот).
> *   Нельзя вводить в базис переменную $\mu_i$, если там уже есть $x_i$ (и наоборот).
>
> Это гарантирует выполнение условий дополняющей нежесткости.

---

## 4. Численный пример (Формирование системы)

**Задача:**
$$ f(x) = x_1^2 + x_2^2 - 2x_1 \to \min $$
Ограничение:
$$ x_1 + x_2 \le 1, \quad x \ge 0 $$

**Решение:**
1.  Градиент функции: $\nabla f = (2x_1 - 2, \ 2x_2)$.
2.  Градиент ограничения: $(1, 1)$.

**Выписываем систему ККТ:**
1.  Производная по $x_1$: $2x_1 - 2 + 1\cdot\lambda - \mu_1 = 0 \Rightarrow 2x_1 + \lambda - \mu_1 = 2$.
2.  Производная по $x_2$: $2x_2 + 0 + 1\cdot\lambda - \mu_2 = 0 \Rightarrow 2x_2 + \lambda - \mu_2 = 0$.
3.  Ограничение: $x_1 + x_2 + y_1 = 1$.

**Таблица для симплекса:**
Решаем систему, соблюдая правило: нельзя $\lambda > 0$ и $y_1 > 0$ одновременно.

---

## 5. Навигация
<< [[Q22 - Дробно-линейная задача]] | [[00_ПЛАН_ПОДГОТОВКИ]] | [[Q24 - Дискретные задачи]] >>
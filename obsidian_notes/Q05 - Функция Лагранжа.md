# Вопрос 5. Классическая задача математического программирования. Функция Лагранжа. Условия экстремума.

**Где читать в учебнике:**
*   **Стр. 133:** Функция Лагранжа и теорема 4.3.
*   **Стр. 136:** Пример решения с проверкой достаточных условий (Пример 4.6).

---

## 1. Формулировки из учебника

> [!info] Классическая задача математического программирования
> **Классической задачей** математического программирования называется задача оптимизации, в которой:
> 1.  Целевая функция $f(x)$ непрерывно дифференцируема.
> 2.  Ограничения заданы **только в виде равенств** ($=$).
> 3.  Ограничений типа неравенств ($\le, \ge$) **нет**.
>
> **Математическая запись:**
> $$
> \begin{cases}
> f(x_1, \dots, x_n) \to \min (\max) \\
> g_i(x_1, \dots, x_n) = 0, \quad i = 1, \dots, m \quad (m < n)
> \end{cases}
> $$
>
> *Почему "классическая"?* Потому что она решается методами классического математического анализа (дифференциального исчисления). Основной метод решения — **метод множителей Лагранжа**.

> [!info] Инструмент: Функция Лагранжа
> Для решения задачи вводится вспомогательная функция:
> $$ L(x, \lambda) = f(x) + \sum_{i=1}^{m} \lambda_i g_i(x) $$
>
> **Разбор компонентов:**
> 4.  **$x$** — вектор управляемых переменных ($n$ штук).
> 5.  **$f(x)$ и $g_i(x)$** — непрерывно дифференцируемые функции.
> 6.  **$\lambda = (\lambda_1, \dots, \lambda_m)$** — Множители Лагранжа (вспомогательные переменные, их столько же, сколько ограничений).

> [!info] Необходимое условие (Теорема Лагранжа)
> Если $x^*$ — точка локального экстремума, и в ней выполняется **Условие регулярности** (см. ниже), то существуют такие числа $\lambda^*$, что градиент функции Лагранжа равен нулю:
>
> $$ \nabla L(x^*, \lambda^*) = 0 $$
>
> Это условие распадается на систему уравнений:
> 7.  **По переменным $x$:**
>     $$ \frac{\partial L}{\partial x_j} = 0 \quad \Rightarrow \quad -\nabla f(x) = \sum_{i=1}^{m} \lambda_i \nabla g_i(x) $$
>     *(Вектор антиградиента функции раскладывается по векторам градиентов ограничений).*
>
> 8.  **По переменным $\lambda$:**
>     $$ \frac{\partial L}{\partial \lambda_i} = 0 \quad \Rightarrow \quad g_i(x) = 0 \quad (\text{Сами ограничения}) $$

> [!warning] Условие регулярности (Условие Якоби)
> Чтобы теорема работала, градиенты ограничений в точке экстремума должны быть **линейно независимы**.
> Ранг матрицы Якоби $J$ (матрицы из частных производных ограничений) должен быть равен числу ограничений $m$:
> $$ \text{rang } J = m $$

> [!info] Достаточное условие экстремума
> Чтобы проверить, является ли найденная точка минимумом, максимумом или седлом, исследуется **второй дифференциал функции Лагранжа**:
> $$ d^2L(x, \lambda) = \sum_{i=1}^{n} \sum_{j=1}^{n} \frac{\partial^2 L}{\partial x_i \partial x_j} dx_i dx_j $$
>
> Проверка делается для векторов $dx$, касательных к ограничениям (удовлетворяющих условию $dg=0$).
>
> *   Если $d^2L > 0$ (положительно определен) — **Условный МИНИМУМ**.
> *   Если $d^2L < 0$ (отрицательно определен) — **Условный МАКСИМУМ**.

---

## 2. Объяснение «на пальцах»

> [!example] Аналогия с туристом на тропе
> Представь, что ты в горах.
> 1.  **Цель ($f$):** Найти самую низкую точку (долину).
> 2.  **Ограничение ($g$):** Ты обязан идти строго по тропинке. Сходить с неё нельзя.
>
> Если ты просто пойдешь вниз по склону (по градиенту $f$), ты уйдешь с тропы.
> В самой низкой точке **тропы** твой путь перестанет вести «вниз» или «вверх». В этой точке сила, тянущая тебя вниз с горы ($\nabla f$), будет перпендикулярна тропе. И вектор ограничения ($\nabla g$) тоже перпендикулярен тропе. Они уравновешивают друг друга.
> $$ \nabla f = -\lambda \nabla g $$

---

## 3. Численный пример (Как решать на экзамене)

**Задача:**
Найти экстремум функции $f(x, y) = x^2 + y^2$ при условии $x + y - 2 = 0$.

### Шаг 1. Составляем функцию Лагранжа
$$ L(x, y, \lambda) = x^2 + y^2 + \lambda(x + y - 2) $$

### Шаг 2. Необходимые условия (Система)
1.  $\frac{\partial L}{\partial x} = 2x + \lambda = 0 \quad \Rightarrow \quad x = -\lambda/2$
2.  $\frac{\partial L}{\partial y} = 2y + \lambda = 0 \quad \Rightarrow \quad y = -\lambda/2$
3.  $x + y - 2 = 0$

### Шаг 3. Решение
Подставим $x$ и $y$ в третье уравнение:
$(-\lambda/2) + (-\lambda/2) - 2 = 0 \Rightarrow -\lambda = 2 \Rightarrow \lambda = -2$.
Тогда $x = 1, y = 1$.
**Подозрительная точка:** $M(1, 1)$, $\lambda = -2$.

### Шаг 4. Проверка достаточного условия
1.  **Вторые производные:**
    $L''_{xx} = 2, \quad L''_{yy} = 2, \quad L''_{xy} = 0$.
    $$ d^2L = 2 dx^2 + 2 dy^2 $$

2.  **Связь дифференциалов (из ограничения):**
    $g(x,y) = x + y - 2 = 0$. Дифференцируем:
    $1 \cdot dx + 1 \cdot dy = 0 \quad \Rightarrow \quad dy = -dx$.

3.  **Подстановка:**
    $d^2L = 2 dx^2 + 2 (-dx)^2 = 4 dx^2$.

4.  **Вывод:**
    $4 dx^2 > 0$ (всегда положительно).
    Значит, точка $(1, 1)$ — **Строгий условный минимум**.

---

## 4. Навигация
<< [[Q04 - Выпуклые функции]] | [[00_ПЛАН_ПОДГОТОВКИ]] | [[Q06 - Методы без производных]] >>
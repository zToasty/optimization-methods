# Вопрос 26. Задача целочисленного линейного программирования. Метод отсечений Гомори.

**Где читать в учебнике:**
*   **Стр. 230:** Геометрическая идея (Рис. 6.4, 6.5).
*   **Стр. 231:** Формула отсечения (6.8).

**Задача:**
$$ f(x) \to \min, \quad Ax = b, \quad x \ge 0, \quad x \in Z \text{ (целые)} $$

---

## 1. Идея метода (Объяснение на пальцах)

> [!example] Скульптор и глина
> Представь, что множество допустимых решений обычной (непрерывной) задачи — это многогранный кусок глины. Внутри него «спрятаны» целые точки (атомы), которые нам нужны.
>
> 1.  **Решаем непрерывную задачу:** Мы находим самую лучшую точку в глине. Оказывается, это дробная точка (например, на самой острой грани).
> 2.  **Отсечение (The Cut):** Мы берем нож и отрезаем этот острый кусок глины (плоскостью).
>     *   **Главное правило:** Мы должны отрезать дробный оптимум, но **не задеть ни одной целой точки** внутри.
> 3.  **Повтор:** У нас получился новый, чуть меньший многогранник. Ищем оптимум в нем. Если он снова дробный — режем еще раз.
> 4.  **Финиш:** В конце концов, грани многогранника станут проходить прямо через целые точки. Очередной непрерывный оптимум окажется целым.

---

## 2. Алгоритм Гомори

> [!info] Шаг 1. Симплекс-метод
> Решаем задачу как обычную линейную (релаксация).
> Если оптимальное решение $x^*$ целочисленное — конец.
> Если есть дробные компоненты — идем дальше.

> [!info] Шаг 2. Выбор строки
> Выбираем строку симплекс-таблицы, в которой базисная переменная $x_k$ имеет **наибольшую дробную часть** $\{b_k\}$.
> Уравнение строки:
> $$ x_k + \sum_{j \in \text{небазис}} a_{kj} x_j = b_k $$

> [!info] Шаг 3. Построение отсечения (Правило Гомори)
> Мы применяем операцию взятия дробной части $\{\cdot\}$ ко всему уравнению.
>
> **Правильное отсечение:**
> $$ \sum_{j \in \text{небазис}} \{a_{kj}\} x_j \ge \{b_k\} $$
>
> *   $\{z\} = z - \lfloor z \rfloor$ — дробная часть числа.
> *   **Важно:** Дробная часть всегда $\ge 0$.
>     *   $\{3.7\} = 0.7$
>     *   $\{-3.7\} = -3.7 - (-4) = \mathbf{0.3}$ (Осторожно с отрицательными числами!).
>
> Для добавления в таблицу (в виде равенства) вводим новую переменную $s_{new} \ge 0$:
> $$ s_{new} - \sum \{a_{kj}\} x_j = -\{b_k\} $$

> [!info] Шаг 4. Решение новой задачи
> Полученная система решается **Двойственным симплекс-методом** (так как свободный член $-\{b_k\}$ стал отрицательным, план недопустим, но оценки оптимальны).
> Возвращаемся к Шагу 1.

---

## 3. Численный пример (Генерация отсечения)

Допустим, последняя строка симплекс-таблицы выглядит так:
$$ x_1 + 1.2 x_2 - 3.7 x_3 = 5.9 $$
Здесь $x_1$ — базисная переменная.
Свободный член $b = 5.9$ — дробный ($\{5.9\}=0.9$).

**Строим отсечение:**
1.  Берем дробные части коэффициентов:
    *   При $x_2$: $\{1.2\} = 0.2$.
    *   При $x_3$: $\{-3.7\} = \mathbf{0.3}$ (а не -0.7!).
    *   От $b$: $\{5.9\} = 0.9$.
2.  Записываем неравенство:
    $$ 0.2 x_2 + 0.3 x_3 \ge 0.9 $$
3.  Вводим переменную $s_1$ и добавляем в таблицу:
    $$ s_1 - 0.2 x_2 - 0.3 x_3 = -0.9 $$

Теперь у нас новая задача. Старое решение (где $x_2=0, x_3=0$) нарушает это условие ($0 \ge 0.9$ — ложь). Мы его успешно отрезали.

---

## 4. Навигация
<< [[Q25 - Метод ветвей и границ]] | [[00_ПЛАН_ПОДГОТОВКИ]] | [[00_БАЗА_ЗНАНИЙ]] >>
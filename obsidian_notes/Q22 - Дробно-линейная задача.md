# Вопрос 22. Задача с дробно-линейной целевой функцией.

**Где читать в учебнике:**
*   **Стр. 187:** Постановка задачи (5.1.1).
*   **Стр. 188:** Замена переменных и сведение к ЛП.

**Суть:** Нам нужно найти оптимум, когда целевая функция — это **дробь** (числитель и знаменатель линейные), а ограничения — обычные линейные.

---

## 1. Постановка задачи

$$ f(x) = \frac{c_1 x_1 + \dots + c_n x_n + c_0}{d_1 x_1 + \dots + d_n x_n + d_0} \to \min $$

При линейных ограничениях:
$$ Ax = b, \quad x \ge 0 $$

**Важное условие:** Знаменатель не должен обращаться в ноль на множестве допустимых решений. Обычно считают, что он строго положителен ($>0$).

---

## 2. Идея решения (Замена переменных)

Мы не умеем решать дроби симплекс-методом. Но мы умеем решать линейные задачи.
Как превратить дробь $\frac{A}{B}$ в линейную функцию?
**Идея:** Давайте сделаем так, чтобы знаменатель стал равен **единице**.

Для этого вводится новая переменная $y_0$, обратная знаменателю:
$$ y_0 = \frac{1}{d_1 x_1 + \dots + d_n x_n + d_0} $$

И новые переменные $y_j$, пропорциональные старым:
$$ y_j = x_j \cdot y_0 $$

---

## 3. Алгоритм сведения к ЛП (Пошагово)

> [!info] Шаг 1. Вводим переменные
> Вместо вектора $x$ ($n$ штук) у нас будет вектор $y$ ($n$ штук) плюс переменная $y_0$.
> $$ y = x \cdot y_0 $$
> $$ x = \frac{y}{y_0} $$

> [!info] Шаг 2. Преобразуем целевую функцию
> Подставим $x = y/y_0$ в формулу $f(x)$. Знаменатель сократится и станет равен 1 (по определению $y_0$).
> Останется только числитель, умноженный на $y_0$:
> $$ L(y, y_0) = \sum_{j=1}^{n} c_j y_j + c_0 y_0 \to \min $$
> Это **линейная** функция!

> [!info] Шаг 3. Преобразуем ограничения
> Старое ограничение: $\sum a_{ij} x_j = b_i$.
> Подставляем $x_j = y_j / y_0$:
> $$ \sum a_{ij} \frac{y_j}{y_0} = b_i \quad \Rightarrow \quad \sum a_{ij} y_j - b_i y_0 = 0 $$
> Это тоже **линейное** уравнение.

> [!info] Шаг 4. Добавляем нормировку
> Мы обязаны зафиксировать, что знаменатель равен $1/y_0$.
> $$ \sum_{j=1}^{n} d_j y_j + d_0 y_0 = 1 $$

> [!info] Шаг 5. Решение и возврат
> 1.  Решаем полученную задачу ЛП (относительно $y$ и $y_0$) обычным **Симплекс-методом** (см. [[Q15 - Симплекс-алгоритм]]).
> 2.  Получаем ответ $(y^*, y_0^*)$.
> 3.  Возвращаемся к исходным иксам:
>     $$ x^* = \frac{y^*}{y_0^*} $$

---

## 4. Численный пример (Трансформация)

**Задача:**
$$ f(x) = \frac{2x_1 + 5}{x_1 + x_2 + 3} \to \max $$
Ограничение:
$$ -x_1 + 3x_2 \le 4 $$

**Решение:**
1.  **Новая переменная $y_0$:**
    $$ y_0 = \frac{1}{x_1 + x_2 + 3} $$
    Вводим $y_1 = x_1 y_0, \quad y_2 = x_2 y_0$.

2.  **Новая целевая функция:**
    Берем числитель: $2x_1 + 5$. Заменяем $x$ на $y$, свободный член умножаем на $y_0$.
    $$ L(y) = 2y_1 + 5y_0 \to \max $$

3.  **Ограничение знаменателя (Нормировка):**
    Берем знаменатель: $1x_1 + 1x_2 + 3$. Приравниваем к 1 в новых переменных.
    $$ 1y_1 + 1y_2 + 3y_0 = 1 $$

4.  **Старое ограничение:**
    $-1x_1 + 3x_2 \le 4$.
    $$ -1y_1 + 3y_2 - 4y_0 \le 0 $$

**Итог:** Получили обычную линейную задачу с 3 переменными ($y_1, y_2, y_0$). Решаем её симплексом, получаем числа, делим $y_1/y_0$ и получаем ответ.

---

## 5. Навигация
<< [[Q21 - Метод штрафных функций]] | [[00_ПЛАН_ПОДГОТОВКИ]] | [[Q23 - Квадратичное программирование]] >>
# Вопрос 17. Лексикографический симплекс алгоритм.

**Где читать в учебнике:**
*   В явном виде этот алгоритм часто дается как дополнение к Симплекс-методу (борьба с зацикливанием). См. замечания к Главе 4 (стр. 185, упоминание итеративных процедур).

**Проблема:** В обычном Симплекс-методе мы выбираем строку, где отношение $\theta = b_i / a_{iq}$ минимально.
А что, если этот минимум достигается **сразу на нескольких строках**? (Например, $b_1/a_{1q} = 2$ и $b_2/a_{2q} = 2$).
Это называется **вырожденный случай**.
*   Мы можем случайно выбрать "не ту" строку.
*   Значение целевой функции не изменится (шаг нулевой длины).
*   Мы можем начать ходить по кругу (менять базисы, оставаясь в одной и той же геометрической точке) бесконечно. Это называется **зацикливание**.

**Решение:** Лексикографический метод — это строгое правило выбора строки, которое гарантирует отсутствие циклов.

---

## 1. Определение лексикографии

Вспомним словарь. Слово "ААА" идет раньше слова "ААБ". Мы сравниваем буквы слева направо.
В математике так сравнивают векторы.

> [!info] Лексикографическое сравнение
> Вектор $X = (x_1, x_2, \dots)$ считается **лексикографически положительным** ($X \succ 0$), если его **первый ненулевой элемент** — положительный.
>
> Вектор $X$ лексикографически меньше вектора $Y$ ($X \prec Y$), если их разность $Y - X \succ 0$.
> *   *Пример:* $(0, 0, 2, -100)$ — положительный (первое ненулевое 2 > 0).
> *   *Пример:* $(0, -1, 100, 100)$ — отрицательный (первое ненулевое -1 < 0).

---

## 2. Алгоритм выбора строки (Правило)

Если при выборе разрешающей строки мы получили одинаковое минимальное отношение $\theta$ для нескольких строк (спорная ситуация), мы расширяем сравнение.

> [!info] Лексикографическое правило
> Вместо того чтобы сравнивать только отношения свободных членов ($b_i / a_{iq}$), мы сравниваем **отношения целых строк** (векторов):
>
> 1.  Берем каждую спорную строку таблицы (включая $b_i$ и все $a_{ij}$).
> 2.  Делим все элементы строки на элемент этой строки в разрешающем столбце ($a_{iq}$).
> 3.  Сравниваем полученные векторы-строки лексикографически (слева направо).
> 4.  Выбираем ту строку, которая **лексикографически минимальна**.
>
> **Гарантия:** Так как все строки симплекс-таблицы линейно независимы (из-за единичной матрицы базиса), совпадений векторов быть не может. Победитель всегда будет один.

---

## 3. Объяснение «на пальцах»

> [!example] Фотофиниш
> Представь забег.
> 1.  **Обычный симплекс:** Мы смотрим, кто прибежал первым (минимальное $b/a$).
> 2.  **Ситуация:** Два бегуна (строка 1 и строка 2) пересекли финиш одновременно. Кого объявить победителем (кого выкинуть из базиса)? Если выбрать наугад, гонку могут заставить перебегать бесконечно.
> 3.  **Лексикография:** Мы включаем камеру фотофиниша и смотрим на миллиметры (следующие столбцы $x_1, x_2, \dots$).
>     *   Смотрим на нос: одинаково.
>     *   Смотрим на плечо: у первого плечо чуть впереди (меньше значение).
>     *   Всё, первый победил.
>
> Это правило просто добавляет микроскопические критерии, чтобы "разрулить" ничью однозначно.

---
---
## 5. Численный пример (Разрешение ничьей)

Предположим, мы решаем задачу Симплекс-методом. Мы уже выбрали **разрешающий столбец $x_2$** (там самая большая отрицательная оценка).
Теперь нам нужно выбрать разрешающую строку (какую переменную исключить из базиса).

**Текущая таблица:**

| Базис | $b$ (План) | $x_1$ | $x_2$ (Pivot) | $x_3$ | $x_4$ |
| :--- | :---: | :---: | :---: | :---: | :---: |
| **Строка 1 ($x_3$)** | **4** | 2 | **2** | 1 | 0 |
| **Строка 2 ($x_4$)** | **6** | 5 | **3** | 0 | 1 |

**Шаг 1. Обычный тест отношений (минимум $\theta$)**
Делим свободный член $b$ на элемент в столбце $x_2$:
*   **Строка 1:** $\theta_1 = 4 / 2 = \mathbf{2}$.
*   **Строка 2:** $\theta_2 = 6 / 3 = \mathbf{2}$.

**Проблема:** Мы получили **2 = 2**. Это ничья.
Если выберем наугад, можем попасть в бесконечный цикл.
Включаем **Лексикографическое правило**.

**Шаг 2. Нормировка строк**
Мы берем всю строку (весь вектор) и делим каждый элемент на разрешающий элемент этой строки (на 2 для первой, на 3 для второй).

*   **Вектор строки 1** (делим на 2):
    $$ V_1 = [4/2, \ 2/2, \ 2/2, \ 1/2, \ 0/2] = [\mathbf{2}, \ 1, \ 1, \ 0.5, \ 0] $$

*   **Вектор строки 2** (делим на 3):
    $$ V_2 = [6/3, \ 5/3, \ 3/3, \ 0/3, \ 1/3] = [\mathbf{2}, \ 1.66, \ 1, \ 0, \ 0.33] $$

**Шаг 3. Сравнение слева направо (Фотофиниш)**
Сравниваем $V_1$ и $V_2$ по элементам по очереди:

1.  **Столбец $b$:** $2 = 2$. (Ничья, идем дальше).
2.  **Столбец $x_1$:**
    *   В строке 1 число **1**.
    *   В строке 2 число **1.66**.
    *   $1 < 1.66$.

**Вывод:** Вектор строки 1 **лексикографически меньше**.
Побеждает **Строка 1**.
Мы выбираем разрешающим элементом число **2** (в первой строке). Переменная $x_3$ покидает базис. Цикла не будет.

---

## 6. Навигация
<< [[Q16 - Метод искусственного базиса]] | [[00_ПЛАН_ПОДГОТОВКИ]] | [[Q18 - Двойственность в ЛП]] >>
# Вопрос 23. Задача квадратичного программирования.

**Где читать в учебнике:**
*   **Стр. 189:** Постановка задачи (5.1.2).
*   **Стр. 190:** Условия Куна-Таккера для этой задачи.
*   **Стр. 191:** Сведение к линейной системе (Пример 5.1).

**Суть:** Целевая функция — **квадратичная** (парабола, чаша), а ограничения — **линейные** (прямые заборы).
$$ f(x) = \text{Квадраты} + \text{Линейная часть} \to \min $$
$$ \text{Ограничения} = \text{Линейные неравенства} $$

---

## 1. Постановка задачи

$$ f(x) = \frac{1}{2} x^T C x + c^T x \to \min $$
При условиях:
$$ Ax \le b, \quad x \ge 0 $$

*   $C$ — симметрическая матрица $n \times n$. Она должна быть **положительно определена** (или полуопределена), чтобы функция была выпуклой (чашей, а не седлом).
*   $A$ — матрица ограничений.

---

## 2. Идея решения (Почему это круто)

В общем случае нелинейные задачи решать сложно. Но здесь нам повезло:
1.  Производная от квадратичной функции — это **линейная** функция (как $(x^2)' = 2x$).
2.  Производная от линейных ограничений — константы.

**Вывод:** Условия Куна-Таккера (которые мы учили в [[Q13 - Теорема Куна-Таккера]]) для этой задачи превратятся в **систему линейных уравнений**.
А линейные системы мы умеем решать **Симплекс-методом**!

---

## 3. Алгоритм (Метод Вольфа / Искусственного базиса)

Мы просто выписываем условия Куна-Таккера и решаем их как систему.

> [!info] Шаг 1. Составляем функцию Лагранжа
> $$ L(x, \lambda) = \frac{1}{2} x^T C x + c^T x + \lambda^T (Ax - b) $$
> (Для задачи на минимум с ограничениями $\le$).

> [!info] Шаг 2. Выписываем условия ККТ
> Нам нужно найти такие $x$ (переменные) и $\lambda$ (множители), чтобы:
>
> 1.  **Производная по $x$ равна 0:**
>     $$ Cx + c + A^T \lambda - \mu = 0 $$
>     *(Здесь $\mu \ge 0$ — это дополнительные множители для условия $x \ge 0$)*.
>
> 2.  **Допустимость (вводим выравнивающие переменные $v$):**
>     $$ Ax + v = b, \quad v \ge 0 $$
>
> 3.  **Условие дополняющей нежесткости (Самое важное!):**
>     $$ \lambda_i \cdot v_i = 0 \quad (\text{Либо множитель 0, либо зазор 0}) $$
>     $$ \mu_j \cdot x_j = 0 $$

> [!info] Шаг 3. Решаем систему модифицированным Симплексом
> У нас получилась большая линейная система:
> $$
> \begin{cases}
> Cx + A^T \lambda - \mu = -c \\
> Ax + v = b
> \end{cases}
> $$
>
> Мы запускаем **Метод искусственного базиса** (см. [[Q16 - Метод искусственного базиса]]).
> **Единственное отличие:** Мы добавляем правило запрета.
> *   Если в базисе есть $x_j$, то нельзя вводить туда $\mu_j$.
> *   Если в базисе есть $v_i$, то нельзя вводить туда $\lambda_i$.
>
> (Это нужно, чтобы выполнялось условие $\lambda \cdot v = 0$).

---

## 4. Численный пример (Формирование системы)

**Задача:**
$$ f(x) = x_1^2 + x_2^2 - 2x_1 \to \min $$
Ограничение:
$$ x_1 + x_2 \le 1, \quad x_{1,2} \ge 0 $$

**Решение:**
1.  Матрица $C = \begin{pmatrix} 2 & 0 \\ 0 & 2 \end{pmatrix}$ (коэффициенты при квадратах, умноженные на 2, т.к. в формуле 1/2).
2.  Вектор $c = (-2, 0)$.
3.  Ограничение $A = (1, 1)$, $b = 1$.

**Выписываем линейную систему (из Шага 2):**
1.  Производная по $x_1$: $2x_1 - 2 + 1\cdot\lambda - \mu_1 = 0 \Rightarrow 2x_1 + \lambda - \mu_1 = 2$.
2.  Производная по $x_2$: $2x_2 + 0 + 1\cdot\lambda - \mu_2 = 0 \Rightarrow 2x_2 + \lambda - \mu_2 = 0$.
3.  Ограничение: $x_1 + x_2 + v = 1$.

**Получили систему для симплекс-таблицы:**
$$
\begin{cases}
2x_1 + \lambda - \mu_1 = 2 \\
2x_2 + \lambda - \mu_2 = 0 \\
x_1 + x_2 + v = 1
\end{cases}
$$
Решаем её, соблюдая правило: нельзя, чтобы одновременно $\lambda > 0$ и $v > 0$.

---

## 5. Навигация
<< [[Q22 - Дробно-линейная задача]] | [[00_ПЛАН_ПОДГОТОВКИ]] | [[Q24 - Дискретные задачи]] >>
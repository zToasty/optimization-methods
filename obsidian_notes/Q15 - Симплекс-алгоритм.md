# Вопрос 15. Симплекс-алгоритм. Критерии остановки.

**Где читать в учебнике:**
*   **Стр. 154:** Теоретическое обоснование.
*   **Стр. 157:** Алгоритм с "правилом прямоугольника".
*   **Стр. 159:** Критерии остановки.

**Суть:** Это метод направленного перебора вершин (БДР). Мы сидим в одной вершине многогранника и смотрим на соседние. Если соседняя вершина "ниже" (лучше по $f(x)$), мы переходим туда. Если все соседи "выше" — мы на дне (оптимум).

---

## 1. Симплекс-таблица

Для расчетов задачу записывают в таблицу.
*   Строки соответствуют **базисным** переменным ($x_i$).
*   Столбцы соответствуют **свободным** переменным ($x_j$).
*   Последняя строка (индексная) содержит оценки $\Delta_j$ (или коэффициенты целевой функции).

---

## 2. Алгоритм (Пошагово)

> [!info] Шаг 1. Проверка на оптимальность (Выбор столбца)
> Смотрим на последнюю строку (строку оценок $f(x)$).
> *   Мы ищем **отрицательный** элемент (если задача на $min$).
> *   Если таких нет (все $\ge 0$) — **СТОП**. Решение найдено (см. критерии ниже).
> *   Если есть отрицательные, выбираем **самый отрицательный** (по модулю самый большой).
> *   Этот столбец $q$ называется **разрешающим**. Переменная $x_q$ войдет в базис (станет $>0$).

> [!info] Шаг 2. Выбор строки (Тест на минимум отношения)
> Смотрим на элементы выбранного столбца $q$. Нам нужно выбрать, какую старую базисную переменную выкинуть.
> Для всех положительных элементов столбца $a_{iq} > 0$ вычисляем отношение свободного члена $b_i$ к этому элементу:
> $$ \theta_i = \frac{b_i}{a_{iq}} $$
> Выбираем строку $k$, где это отношение **минимально**.
> $$ \min \{ \frac{b_i}{a_{iq}} \mid a_{iq} > 0 \} $$
> Эта строка $k$ — **разрешающая**. Переменная $x_k$ уйдет из базиса (станет 0).
>
> *Элемент на пересечении строки $k$ и столбца $q$ называется **разрешающим элементом**.*

> [!info] Шаг 3. Пересчет таблицы (Метод Жордана-Гаусса)
> Мы делаем шаг в новую вершину. Таблица полностью пересчитывается.
>
> 1.  **Разрешающий элемент** заменяем на обратный: $1 / a_{kq}$.
> 2.  **Строка** разрешающая делится на элемент.
> 3.  **Столбец** разрешающий делится на элемент (с минусом).
> 4.  **Остальные элементы** пересчитываются по **правилу прямоугольника**:
> $$ a_{new} = a_{old} - \frac{a_{row} \cdot a_{col}}{a_{pivot}} $$
> (Старый элемент минус произведение проекций, деленное на разрешающий).

Возвращаемся к Шагу 1.

---

## 3. Критерии остановки (Это отдельная часть вопроса!)

В любой момент алгоритма может наступить одно из трех состояний:

> [!info] 1. Критерий оптимальности (Успех)
> Если в индексной строке (строке целевой функции) **нет отрицательных элементов** (для задачи на минимум), то текущее базисное решение является оптимальным.
> $$ \Delta_j \ge 0 \quad \forall j $$
> *Смысл:* Куда бы мы ни дернулись, функция только вырастет. Мы в яме.

> [!info] 2. Критерий неограниченности (Провал)
> Если мы выбрали столбец с отрицательной оценкой (хотим уменьшить функцию), но в этом столбце **нет ни одного положительного элемента** ($a_{iq} \le 0$ для всех $i$), то функцию можно уменьшать бесконечно.
> $$ f(x) \to -\infty $$
> Задача не имеет решения из-за неограниченности. Многогранник "дырявый".

> [!info] 3. Альтернативный оптимум (Много решений)
> Если критерий оптимальности выполнен (все $\ge 0$), но одна из оценок для *свободной* переменной равна **нулю**, значит, есть целое ребро "дна". У задачи бесконечно много решений.

---

## 4. Объяснение «на пальцах»

> [!example] Жук на алмазе
> Представь многогранник (алмаз). Мы — жук, который хочет спуститься в самую нижнюю точку. Мы сидим на вершине.
>
> 1.  **Выбор столбца:** Мы смотрим на ребра, исходящие из нашей вершины. Отрицательная оценка в таблице — это ребро, которое ведет **вниз**. Мы выбираем самое крутое (самый большой минус).
> 2.  **Выбор строки:** Мы ползем по этому ребру. Как долго ползти? Пока не упремся в следующую вершину. Отношение $b_i / a_{iq}$ показывает расстояние до соседних стенок. Мы выбираем **ближайшую** (минимальное $\theta$), чтобы не вылететь за пределы алмаза.
> 3.  **Пересчет:** Мы переползли в новую вершину. Теперь мир выглядит иначе, нужно обновить карту (таблицу).

---

## 5. Численный пример (По шагам)

**Задача:**
$$ f(x) = -2x_1 - x_2 \to \min $$
Ограничения:
$$ \begin{cases} x_1 + x_2 \le 3 \\ x_1 \le 2 \\ x_1, x_2 \ge 0 \end{cases} $$

**Шаг 0. Приведение к каноническому виду**
Ограничения-неравенства превращаем в равенства, добавляя **слабые** (базисные) переменные $x_3$ и $x_4$:
1. $x_1 + x_2 + x_3 = 3$
2. $x_1 + 0 + x_4 = 2$

Целевая функция: $f = -2x_1 - x_2 + 0x_3 + 0x_4$.
Начальный базис: $x_3, x_4$ (они уже выражены: $x_3=3, x_4=2$). Свободные: $x_1, x_2 = 0$.

**Таблица 1 (Начальная)**

| Базис | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $b$ (План) |
| :--- | :---: | :---: | :---: | :---: | :---: |
| **$x_3$** | 1 | 1 | 1 | 0 | **3** |
| **$x_4$** | **1** | 0 | 0 | 1 | **2** |
| **$f(x)$** | **-2** | -1 | 0 | 0 | **0** |

**Итерация 1:**
1.  **Выбор столбца:** В строке $f(x)$ ищем самый большой минус. Это **-2** (столбец $x_1$). Мы хотим увеличить $x_1$.
2.  **Выбор строки:** Считаем отношения $b_i / a_{i1}$:
    *   Строка $x_3$: $3 / 1 = 3$.
    *   Строка $x_4$: $2 / 1 = 2$.
    *   Минимум — **2** (строка $x_4$).
3.  **Разрешающий элемент:** Пересечение строки $x_4$ и столбца $x_1$ — это число **1** (выделено).
4.  **Замена:** $x_4$ уходит из базиса, $x_1$ приходит.

**Пересчет таблицы (Метод прямоугольника):**
*   Строка $x_1$ (бывшая $x_4$) просто делится на 1 (не меняется).
*   Строка $x_3$: $New = Old - Coeff \times Row_{new}$.
    *   $x_3(new) = 3 - 1 \times 2 = 1$.
*   Строка $f(x)$: чтобы обнулить -2, прибавляем $2 \times Row_{new}$.

**Таблица 2**

| Базис | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $b$ |
| :--- | :---: | :---: | :---: | :---: | :---: |
| **$x_3$** | 0 | **1** | 1 | -1 | **1** |
| **$x_1$** | 1 | 0 | 0 | 1 | **2** |
| **$f(x)$** | 0 | **-1** | 0 | 2 | **4** |

**Анализ:**
В строке $f(x)$ всё еще есть минус (**-1** в столбце $x_2$). Решение не оптимально.
Нужна еще итерация.
1.  Столбец $x_2$.
2.  Отношения:
    *   Строка $x_3$: $1 / 1 = 1$. (Минимум).
    *   Строка $x_1$: $2 / 0$ — нельзя делить.
3.  Разрешающий элемент: **1** (в строке $x_3$). $x_3$ уходит, $x_2$ приходит.

**Таблица 3 (Финиш)**

| Базис | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $b$ |
| :--- | :---: | :---: | :---: | :---: | :---: |
| **$x_2$** | 0 | 1 | 1 | -1 | **1** |
| **$x_1$** | 1 | 0 | 0 | 1 | **2** |
| **$f(x)$** | 0 | 0 | 1 | 1 | **5** |

**Проверка:**
В строке $f(x)$ все числа $\ge 0$ ($0, 0, 1, 1$).
**СТОП.** Оптимум найден.
**Ответ:** $x_1 = 2, x_2 = 1$. Значение функции $f_{min} = -5$ (обратите внимание, в таблице часто пишут с обратным знаком или накапливают минус, тут значение $-2(2) - 1 = -5$).

## 6. Навигация
<< [[Q14 - Линейное программирование (ЛП)]] | [[00_ПЛАН_ПОДГОТОВКИ]] | [[Q16 - Метод искусственного базиса]] >>
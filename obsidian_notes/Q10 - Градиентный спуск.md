# Вопрос 10. Оптимизация функций многих переменных. Метод градиентного спуска.

**Где читать в учебнике:**
*   **Стр. 72:** Определение градиента (Раздел 3.1.3).
*   **Стр. 108:** Общая схема градиентного спуска (3.6.1).
*   **Стр. 111:** Метод наискорейшего спуска (3.6.2).

**Суть:** В отличие от метода покоординатного спуска (где мы ходили только Север-Юг-Запад-Восток), здесь мы вычисляем производные и идем **строго вниз по склону**, в любую сторону.

---

## 1. Что такое Градиент? (База)

> [!info] Определение Градиента
> **Градиент** функции $f(x)$ в точке $x$ (обозначается $\nabla f(x)$ или $f'(x)$) — это вектор, составленный из частных производных:
> $$ f'(x) = \left( \frac{\partial f}{\partial x_1}, \frac{\partial f}{\partial x_2}, \dots, \frac{\partial f}{\partial x_n} \right) $$
>
> **Физический смысл:**
> 1.  Вектор градиента показывает направление **наискорейшего возрастания** функции (круче всего в гору).
> 2.  Вектор **антиградиента** ($-f'(x)$) показывает направление **наискорейшего убывания** (круче всего вниз).
> 3.  Длина вектора ($||f'(x)||$) показывает крутизну склона. Если она равна 0, мы на равнине (экстремум).

---

## 2. Идея метода (Объяснение на пальцах)

> [!example] Лыжник в тумане
> Представь, что ты лыжник на вершине горы, вокруг густой туман, и ты хочешь спуститься в долину (к минимуму).
>
> 1.  **Осмотр:** Ты смотришь под ноги и щупаешь палкой склон вокруг себя.
> 2.  **Выбор направления:** Ты находишь, в какую сторону склон уходит вниз круче всего. (Это направление антиградиента).
> 3.  **Шаг:** Ты делаешь шаг (или едешь какое-то время) в эту сторону.
> 4.  **Повтор:** В новой точке ты останавливаешься и снова щупаешь склон. Направление может измениться (гора же изгибается).
>
> Траектория твоего спуска будет плавной кривой линией, перпендикулярной линиям высоты.

---

## 3. Общий алгоритм (Стр. 108)

Мы строим последовательность точек $x^0, x^1, x^2, \dots$ по формуле:

$$ x^{k+1} = x^k - \alpha_k \cdot f'(x^k) $$

Где:
*   $x^k$ — текущая точка.
*   $f'(x^k)$ — вектор градиента в этой точке.
*   "Минус" — потому что нам надо вниз (против градиента).
*   $\alpha_k$ (альфа) — **длина шага** (шаговый множитель).

**Главный вопрос:** Как выбрать длину шага $\alpha_k$?
1.  **Постоянный шаг:** $\alpha_k = const$ (рискованно: можно перепрыгнуть яму).
2.  **Дробление шага:** Если шагнули и стало хуже (функция выросла), уменьшаем шаг в 2 раза и пробуем снова.
3.  **Наискорейший спуск:** (См. ниже).

---

## 4. Метод наискорейшего спуска (Стр. 111)

Это "умный" вариант градиентного спуска.
Мы не просто делаем шаг фиксированной длины, а ищем, **насколько далеко** выгодно пройти в выбранном направлении, прежде чем повернуть.

> [!info] Алгоритм наискорейшего спуска
>
> **Шаг 1.** Вычислить градиент в текущей точке: $p^k = -f'(x^k)$.
>
> **Шаг 2.** Проверка остановки: Если длина градиента $||p^k|| < \varepsilon$, то стоп. Мы на дне.
>
> **Шаг 3.** Выбор длины шага.
> Мы превращаем задачу в **одномерную**. Мы идем по лучу $x^k + \alpha p^k$.
> Находим такое $\alpha_k$, которое минимизирует функцию вдоль этого луча:
> $$ \Phi(\alpha) = f(x^k + \alpha p^k) \to \min_{\alpha > 0} $$
> (Тут используются методы из Вопроса 6: золотое сечение и т.д.).
>
> **Шаг 4.** Делаем шаг: $x^{k+1} = x^k + \alpha_k p^k$.
>
> **Важное свойство:** В методе наискорейшего спуска каждый новый шаг **перпендикулярен** предыдущему (зигзаг). Потому что мы идем по прямой до тех пор, пока она не перестанет спускаться (станет касательной к линии уровня), а потом поворачиваем на 90 градусов в новый спуск.

---

## 5. Навигация
<< [[Q09 - Покоординатный спуск]] | [[00_ПЛАН_ПОДГОТОВКИ]] | [[Q11 - Метод Ньютона (многомерный)]] >>
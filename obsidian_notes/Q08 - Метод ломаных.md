# Вопрос 8. Метод ломаных минимизации многомодальной функции.

**Где читать в учебнике:**
*   **Стр. 59-60:** Идея метода и графическая иллюстрация (Рис 2.14, 2.15).
*   **Стр. 63:** Подробный алгоритм.

**Для чего это:** Чтобы найти **глобальный минимум** функции, у которой много ям (локальных минимумов).
**Главное условие:** Мы должны знать число $L$ (Константа Липшица) — это **максимально возможная скорость** изменения функции (максимальный наклон касательной).

---

## 1. Суть метода (Геометрический смысл)

Представь, что мы ищем дно озера. Мы не видим дно, но сделали два замера глубины:
1.  В точке $A$ глубина 10 метров.
2.  В точке $B$ глубина 20 метров.

Мы знаем правило природы ($L$): глубина не может меняться резче, чем под углом 45 градусов.
Это значит, что от точки $A$ дно может уходить вниз, но **не круче**, чем линия с наклоном $-L$. И от точки $B$ оно может идти вниз **не круче**, чем линия с наклоном $+L$.

Если нарисовать эти две линии, они пересекутся в какой-то точке внизу. Образуется галочка (конус) $\lor$.
**Точка пересечения (острие галочки)** — это самое глубокое место, которое *теоретически* может существовать между точками $A$ и $B$. Глубже быть не может — это нарушит правило $L$.

**Метод ломаных** — это процесс покрытия всего графика такими "галочками" снизу. Нижняя граница этих галочек называется **минорантой**.

---

## 2. Ключевые формулы (Откуда берутся числа)

Пусть у нас есть две точки, в которых мы уже знаем значение функции:
*   Левая точка: $(x_1, y_1)$, где $y_1 = f(x_1)$.
*   Правая точка: $(x_2, y_2)$, где $y_2 = f(x_2)$.

Мы пускаем из них лучи с наклоном $L$:
1.  Из левой точки вниз-вправо: наклон $-L$.
2.  Из правой точки вниз-влево: наклон $+L$.

**Координаты точки пересечения $(\tilde{x}, \tilde{p})$:**
(Эти формулы есть на стр. 60, формула 2.29).

1.  **Где искать (координата X):**
    $$ \tilde{x} = \frac{1}{2}(x_1 + x_2) + \frac{f(x_1) - f(x_2)}{2L} $$
    *   *Смысл:* Это середина отрезка + поправка. Если слева высота больше ($f(x_1)$ большое), то минимум сместится вправо.

2.  **Какая там оценка минимума (координата Y):**
    $$ \tilde{p} = \frac{f(x_1) + f(x_2)}{2} - L \cdot \frac{x_2 - x_1}{2} $$
    *   *Смысл:* Это средняя высота минус спуск. Чем шире расстояние между точками ($x_2 - x_1$), тем глубже может "провиснуть" функция.

---

## 3. Подробный алгоритм (по шагам)

> [!info] Алгоритм метода Пиявского (ломаных)
>
> **Дано:** Отрезок $[a, b]$, константа $L$, точность $\varepsilon$.
>
> **Шаг 0 (Старт):**
> *   Вычисляем функцию на краях: $f(a)$ и $f(b)$.
> *   Строим первую "галочку" между $a$ и $b$. Находим её острие (точку минимума ломаной) по формулам выше. Назовем её $(\tilde{x}, \tilde{p})$.
> *   Запоминаем текущий рекордный минимум функции: $f^* = \min(f(a), f(b))$.
>
> **Шаг 1 (Проверка):**
> *   Сравниваем наш реальный рекорд $f^*$ и теоретическое дно $\tilde{p}$.
> *   Если $f^* - \tilde{p} \le \varepsilon$ — стоп. Мы доказали, что глубже, чем на $\varepsilon$, нырнуть невозможно.
>
> **Шаг 2 (Действие):**
> *   Если разрыв большой, мы идем в точку $\tilde{x}$ (туда, где острие галочки) и вычисляем реальное значение $f(\tilde{x})$.
> *   Обновляем рекорд $f^*$, если нашли значение лучше.
>
> **Шаг 3 (Перестроение):**
> *   Теперь у нас есть новая точка на графике. Старая большая галочка разбивается этой точкой на **две маленькие галочки** (слева и справа от новой точки).
> *   Вся наша "пила" (ломаная) поднимается выше и становится ближе к графику.
> *   Ищем **самое низкое** острие среди всех галочек, которые у нас есть. Это новая $\tilde{x}$.
> *   Возврат к Шагу 1.

---

## 4. Пример «Вдоль и поперек» (Ручной расчет)

Давай возьмем простую функцию, чтобы цифры были красивыми.
**Задача:** Найти минимум $f(x) = |x|$ на отрезке $[-2, 2]$.
Мы знаем, что минимум в $0$, но алгоритм этого не знает.
Пусть константа Липшица $L = 2$ (взяли с запасом, реально наклон там 1).

### Инициализация (Шаг 0)
1.  **Точки:** $x_1 = -2, x_2 = 2$.
2.  **Значения:**
    *   $f(-2) = |-2| = 2$.
    *   $f(2) = |2| = 2$.
    *   Рекорд $f^* = 2$.
3.  **Строим первую галочку:**
    *   $x_{вершины} = \frac{-2 + 2}{2} + \frac{2 - 2}{2 \cdot 2} = 0 + 0 = 0$.
    *   $p_{вершины} = \frac{2 + 2}{2} - 2 \cdot \frac{2 - (-2)}{2} = 2 - 2 \cdot \frac{4}{2} = 2 - 4 = -2$.
    *   *Смысл:* Алгоритм говорит: "Между точками -2 и 2 теоретически может быть яма глубиной до -2".
    *   Точка претендент: $\tilde{x} = 0$. Оценка $\tilde{p} = -2$.

### Итерация 1
1.  **Проверка:** $f^* - \tilde{p} = 2 - (-2) = 4$. Это много (больше $\varepsilon$). Продолжаем.
2.  **Замер:** Идем в точку $\tilde{x} = 0$.
    *   Считаем реально $f(0) = |0| = 0$.
    *   Обновляем рекорд: был 2, стал **0**. ($f^* = 0$).
3.  **Перестроение:**
    Теперь у нас 3 известные точки: $x=-2, x=0, x=2$.
    *   Старая галочка (от -2 до 2) удаляется.
    *   Появляются две новые:
        1.  **Левая (от -2 до 0):**
            *   $f(-2)=2, f(0)=0$.
            *   $x_{верш} = \frac{-2+0}{2} + \frac{2-0}{4} = -1 + 0.5 = -0.5$.
            *   $p_{верш} = \frac{2+0}{2} - 2 \cdot \frac{0 - (-2)}{2} = 1 - 2 = -1$.
        2.  **Правая (от 0 до 2):**
            *   $f(0)=0, f(2)=2$.
            *   Аналогично, $x_{верш} = 0.5$, $p_{верш} = -1$.
    *   **Выбор:** У нас две ямы с глубиной $-1$. Выбираем любую, например, левую ($\tilde{x} = -0.5$).

### Итерация 2
1.  **Проверка:** $f^* - \tilde{p} = 0 - (-1) = 1$. Допустим, нам нужна точность 0.1. Продолжаем.
2.  **Замер:** Идем в точку $\tilde{x} = -0.5$.
    *   $f(-0.5) = 0.5$.
    *   Рекорд $f^*$ не обновился (0 лучше, чем 0.5).
3.  **Перестроение:**
    Левая галочка (от -2 до 0) разбивается точкой -0.5 на две малюсенькие. Их глубина будет еще выше (ближе к 0).
    Самой глубокой осталась **правая** галочка (с прошлого шага) с вершиной в $0.5$ и глубиной $-1$.
    
    Алгоритм пойдет проверять правую сторону.

**Итог:** Мы начали с огромной оценки "минимум может быть -2". Сделали замер в центре — поняли "нет, тут 0". Оценка снизу поднялась до -1. Сделали замеры сбоку — оценка поднимется до -0.5 и так далее, пока пила не прижмется к графику функции $y=|x|$.

---

![[lomani.gif]]
## 5. Навигация
<< [[Q07 - Методы с производными]] | [[00_ПЛАН_ПОДГОТОВКИ]] | [[Q09 - Покоординатный спуск]] >>